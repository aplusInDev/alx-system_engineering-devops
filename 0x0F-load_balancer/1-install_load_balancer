#!/usr/bin/env bash
# Install HAProxy (use sudo if not running as root)

sudo apt update
sudo apt-get install -y haproxy

# Configure HAProxy
sudo echo "ENABLED=1" >> /etc/default/haproxy

# Create a backup of the original configuration file
sudo cp /etc/haproxy/haproxy.cfg /etc/haproxy/haproxy.cfg.bak

# Create a new configuration file
sudo echo "frontend aplusdev.tech
    bind *:80
    use_backend aplus_servers" >> /etc/haproxy/haproxy.cfg

sudo echo "backend aplus_servers
    balance roundrobin
    server web-01 100.25.20.254:80 check
    server web-02 54.144.154.99:80 check" >> /etc/haproxy/haproxy.cfg

sudo service haproxy restart
